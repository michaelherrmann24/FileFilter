!function(){APP={NAME:"FileFilter",MODULE:{MAIN:"FF_Main",FILE:"FF_File",COMMON:"FF_Common",NAV:"FF_Nav",FILTERS:"FF_Filters",MENU:"FF_MENU"}},angular.element(document).ready(function(){angular.module(APP.NAME,[APP.MODULE.MAIN,APP.MODULE.FILE,APP.MODULE.COMMON,APP.MODULE.NAV,APP.MODULE.MENU,APP.MODULE.FILTERS]),angular.bootstrap(document,[APP.NAME])})}(),function(){"use strict";angular.module(APP.MODULE.COMMON,[])}(),function(){"use strict";angular.module(APP.MODULE.FILE,[])}(),function(){"use strict";angular.module(APP.MODULE.FILTERS,[])}(),function(){"use strict";angular.module(APP.MODULE.MAIN,[])}(),function(){"use strict";angular.module(APP.MODULE.MENU,[])}(),function(){"use strict";angular.module(APP.MODULE.NAV,[])}(),function(){"use strict";angular.module(APP.MODULE.COMMON).constant("SITE",{HTML:{BASE_DIR:"./dist/templates"}})}(),function(){"use strict";function a(a,b){function c(b){return"undefined"!=typeof k.deferred&&i(),k.deferred=a.defer(),k.execute=new d(b),k.execute.run().then(g,f)["finally"](function(){k.cancelled=!1}),k.deferred.promise}function d(c){function d(c,i){return g?a.reject("cancelled"):c<i.file.size?i.fileReader.read(c,c+j).then(function(a){for(var f=a,g=c;f.length>0;){var j=f.indexOf("\n");if(-1==j){if(g+f.length===i.file.size){var k=new k(i.fileMap.length,g,i.file.size);g=g+f.length+1,i.fileMap.push(k)}break}var k=new e(i.fileMap.length,g,g+j);g=g+j+1,i.fileMap.push(k),f=f.length-1<j+1?"":f.substring(j+1,f.length-1),i.fileMap.length===b.model.linesPerPage&&h(i.fileMap.length)}return d(g,i)},f):(console.debug("file finished.",i),i)}this.file=c,this.currentPosition=0;var g=!1;this.cancel=function(){g=!0},this.run=function(){return d(0,c)}}function e(a,b,c){return this.row=a,this.start=b,this.end=c,this}function f(a){console.error("Error Generating File Map",a),k.deferred.reject(a)}function g(a){k.deferred.resolve(a)}function h(a){console.debug("first-page-complete",a),k.deferred.notify("first-page-complete")}function i(){k.execute.cancel(),k.deferred.reject("generate-cancelled")}var j=10485760,k={},l={generate:c};return l}angular.module(APP.MODULE.COMMON).service("fileMapGenerator",["$q","pageView",a])}(),function(){"use strict";function a(a,b){function c(b){return"undefined"!=typeof i.execute,"undefined"!=typeof i.deferred&&h(),i.deferred=a.defer(),i.execute=new d(b),i.execute.run().then(f,e)["finally"](function(a){console.debug("finally result",a),i.cancelled=!1}),i.deferred.promise}function d(c){function d(a){for(var b=a;b.parent;)b=b.parent;return b}var e=c,f=0,h=d(c),i=!1,j=e.fileMap;-1===e.value.indexOf(e.prevValue)&&(j=e.parent.fileMap),this.cancel=function(){i=!0},this.run=function(){function c(){for(var c=[];f<j.length&&c.length<b.model.linesPerPage&&!i;){var e=j[f];f++,c.push(new d(e))}return c.length>0&&!i?a.all(c).then(k):void 0}function d(a){var b=a;return h.readLine(b).then(function(a){return{line:b,lineValue:a}})}function k(a){for(var b in a)e.run(a[b].line,a[b].lineValue);return f<j.length&&!i?(g(),c()):e.fileMap}return e.startRun(),c()}}function e(a){console.error("Error Generating File Map",a),i.deferred.reject(a)}function f(a){i.deferred.resolve(a)}function g(a){i.deferred.notify("page-complete")}function h(){i.execute.cancel(),i.deferred.reject("generate-cancelled")}var i={},j={generate:c,cancel:h};return j}angular.module(APP.MODULE.COMMON).service("filterMapGenerator",["$q","pageView",a])}(),function(){"use strict";function a(a){function b(a,b){return c(a,b),{pre:d,post:e}}function c(a,b){}function d(a,b,c){}function e(a,b,c){}return{restrict:"E",templateUrl:"./dist/templates/svgIcon.htm",replace:!0,scope:{icon:"@",iconClass:"="},compile:b}}angular.module(APP.MODULE.COMMON).directive("svgIcon",["$document",a])}(),function(){"use strict";function a(){return{restrict:"E",templateUrl:"./dist/svg/svg-defs.comb.min.svg",replace:!0,scope:{}}}angular.module(APP.MODULE.COMMON).directive("svgInclude",[a])}(),function(){"use strict";function a(a,b,c,d){return{restrict:"E",templateUrl:d.HTML.BASE_DIR+"/fileContent.htm",replace:!0,scope:{},link:function(c,d,e){c.pageView=b,c.displayView=a}}}angular.module(APP.MODULE.FILE).directive("fileContent",["fileView","pageView","filtersView","SITE",a])}(),function(){function a(a,b){function c(b,c,d){b.fileView=a}return{restrict:"E",templateUrl:b.HTML.BASE_DIR+"/fileDetails.htm",replace:!0,transclude:!0,scope:{},controller:["$scope","$element","$attrs",c],controllerAs:"fileDetailsCtrl"}}angular.module(APP.MODULE.FILE).directive("fileDetails",["fileView","SITE",a])}(),function(){"use strict";function a(a,b){return{restrict:"A",link:function(b,c,d){a.model.readLine(b.line).then(function(a){b.lineContent=a,b.lineNo=b.line.lineNO})}}}angular.module(APP.MODULE.FILE).directive("fileLine",["fileView","SITE",a])}(),function(){"use strict";function a(a){function b(a){this.file=a}function c(a,b){return function(){b.resolve(a.result)}}function d(a,b){return function(){b.reject(a.result)}}function e(a){var b=new FileReader;return b.onload=c(b,a),b.onerror=d(b,a),b}return b.prototype.readBytes=function(b,c){var d=a.defer(),f=e(d);return f.readAsArrayBuffer(this.file.slice(b,c)),d.promise},b.prototype.read=function(b,c){var d=a.defer(),f=e(d);return f.readAsText(this.file.slice(b,c)),d.promise},b.newInstance=function(a){return new b(a)},b}angular.module(APP.MODULE.FILE).service("fileReaderSrvc",["$q",a])}(),function(){"use strict";function a(a,b,c,d,e,f,g){function h(a,h,i){function j(a){a.stopPropagation(),a.preventDefault(),a.dataTransfer.dropEffect="copy"}function k(h){h.stopPropagation(),h.preventDefault(),b.model=e.newInstance(h.dataTransfer.files[0]),c.model=f.newInstance(),d.model=b.model.filter,console.debug("filtersView.model",d.model),g.generate(b.model).then(function(a){console.debug("file map completed",a),b.model=a},function(a){console.debug("error",a)},function(a){console.debug("notify update",a)})["finally"](function(){a.$applyAsync()})}h.bind("dragover",j),h.bind("drop",k)}return{restrict:"A",scope:{type:"@fileSelect"},controller:["$scope","$element","$attrs",h],controllerAs:"fileSelectCtrl"}}angular.module(APP.MODULE.FILE).directive("fileSelect",["$timeout","fileView","pageView","filtersView","filteredFileModel","pageFactory","fileMapGenerator",a])}(),function(){function a(a){return function(d){if(angular.isDefined(d)&&!isNaN(d)){for(var e=0,f=1;d/f>1;)f*=c,e++;var g=d/(f/c);return a("number")(g,2)+" "+b[e-1]}return d}}angular.module(APP.MODULE.FILE).filter("fileSizeFilter",["$filter",a]);var b=["B","KB","MB","GB","TB"],c=1024}(),function(){"use strict";function a(){var a;Object.defineProperty(this,"model",{configurable:!1,enumerable:!1,get:function(){return a},set:function(b){a=b}})}angular.module(APP.MODULE.FILE).service("fileView",[a])}(),function(){"use strict";function a(a,b){function c(a){this.file=a,this.fileReader=b.newInstance(a),this.fileMap=[]}return c.prototype.readLine=function(a){return this.fileReader.read(a.start,a.end)},c.newInstance=function(a){return new c(a)},c}angular.module(APP.MODULE.FILE).service("fileModel",["$q","fileReaderSrvc",a])}(),function(){"use strict";function a(a,b,c,d){function e(a){b.call(this,a),this.filter=d.newBaseFilter(this),Object.defineProperty(this,"displayMap",{configurable:!1,enumerable:!1,get:function(){return this.filter?this.filter.displayMap:this.fileMap},set:angular.noop})}return e.prototype=Object.create(b.prototype),e.prototype.constructor=e,e.prototype.generateFileMap=function(){console.debug("generating file Map",this);return this.fileReader=c.newInstance(this.file),nextGenMapChunk(0,this)},e.prototype.readLine=function(a){return this.fileReader.read(a.start,a.end)},e.newInstance=function(a){return new e(a)},e}angular.module(APP.MODULE.FILE).service("filteredFileModel",["$q","fileModel","fileReaderSrvc","filterFactory",a])}(),function(){"use strict";function a(a,b){var c={};return c.newBaseFilter=function(b){return new a(b)},c}angular.module(APP.MODULE.FILTERS).service("filterFactory",["baseFilter","orFilter",a])}(),function(){"use strict";function a(a,b,c){function d(a){var b,c,d;this.parent=a,this.fileMap=a.fileMap,this.id=e++,Object.defineProperty(this,"value",{configurable:!1,enumerable:!1,get:function(){return c},set:function(a){d=c,c=a}}),Object.defineProperty(this,"filter",{configurable:!1,enumerable:!1,get:function(){return b},set:function(a){b=a}}),Object.defineProperty(this,"displayMap",{configurable:!1,enumerable:!1,get:this.getFileMap,set:angular.noop})}var e=0;return d.prototype.startRun=function(){this.fileMap=[],this.filter&&this.filter.startRun()},d.prototype.run=function(a,b){("undefined"==typeof this.value||""===this.value.trim()||-1!==b.search(this.value))&&(this.fileMap.push(a),this.filter&&this.filter.run(a,b))},d.prototype.addFilter=function(a){this.filter?this.filter.addFilter(a):this.filter=a},d.prototype.removeFilter=function(){this.filter?this.parent.filter=this.filter:delete this.parent.filter},d.prototype.getFileMap=function(){return this.filter?this.filter.displayMap:this.fileMap},d}angular.module(APP.MODULE.FILTERS).service("baseFilter",["$q","$timeout","fileView",a])}(),function(){"use strict";function a(a,b){function c(a){b.call(this,a),this.orFilterIndex=0,this.filter={}}return c.prototype=Object.create(b.prototype),c.prototype.constructor=c,c.prototype.addFilter=function(a){this.filter[a.id]=a},c.prototype.removeFilter=function(a){delete this.filter[a.orIndex]},c.prototype.getFileMap=function(){if(this.hasFilters()){var a=(this.getFirst(),this.getFirst().displayMap);return a}return this.fileMap},c.prototype.run=function(a){this.hasFilters()&&this.getFirst().run(a)},c.prototype.notifyParent=function(){b.prototype.notifyParent.apply(this,[])},c.prototype.getFirst=function(){for(var a in this.filter)return this.filter[a]},c.prototype.hasFilters=function(){for(var a in this.filter)return!0;return!1},c}angular.module(APP.MODULE.FILTERS).factory("orFilter",["$q","baseFilter",a])}(),function(){"use strict";function a(a){function b(b,c,d){console.debug("link",b.filter),b.$watch(function(){return b.filter.value},function(c,d){"undefined"!=typeof c&&""!==c.trim()?a.generate(b.filter).then(function(a){console.debug("success",a,b.filter.displayMap),b.$applyAsync()},function(a){console.debug("err",a)},function(a){console.debug("notify",a)}):(a.cancel(),b.filter.fileMap=b.filter.parent.fileMap)})}function c(a,b,c){}return{restrict:"E",templateUrl:"./templates/filters/filter.htm",replace:!0,scope:{filter:"=filter"},controller:["$scope","$element","$attrs",c],controllerAs:"filterCtrl",link:b}}angular.module(APP.MODULE.FILTERS).directive("groupFilter",["filterMapGenerator",a])}(),function(){"use strict";function a(a){function b(a,b,c){a.filters=[],a.filters.push(a.group);for(var d=a.group;"undefined"!=typeof d.filter;)d=d.filter,a.filters.push(d)}function c(a,b,c){this.addFilter=function(){},this.removeGroup=function(){}}return{restrict:"E",templateUrl:"./templates/filters/filterGroup.htm",replace:!0,scope:{group:"=group"},controller:["$scope","$element","$attrs",c],controllerAs:"filterGroupCtrl",link:b}}angular.module(APP.MODULE.FILTERS).directive("filterGroup",["filterFactory",a])}(),function(){"use strict";function a(a,b){function c(a,c,d){console.debug("filtersView",b),console.debug("filtersView,model",b.model),this.view=b,this.addGroup=function(){},this.removeGroup=function(a){b.removeFilter(a)},this.addFilter=function(a){b.addFilter(a)},this.removeFilter=function(a){b.removeFilter(a)}}return{restrict:"E",templateUrl:"./templates/filters/filters.htm",replace:!0,scope:{},controller:["$scope","$element","$attrs",c],controllerAs:"filtersCtrl"}}angular.module(APP.MODULE.FILTERS).directive("filters",["filterFactory","filtersView",a])}(),function(){"use strict";function a(a){function b(){var a;this.filters;var b=!1;return Object.defineProperty(this,"model",{configurable:!1,enumerable:!1,get:function(){return a},set:function(b){a=b}}),Object.defineProperty(this,"visible",{configurable:!1,enumerable:!1,get:function(){return b},set:function(a){b=a}}),this}return b.prototype.toggleVisible=function(){this.visible=!this.visible},b.prototype.addFilter=function(a){},b.prototype.removeFilter=function(a){},new b}angular.module(APP.MODULE.FILTERS).service("filtersView",["filterFactory",a])}(),function(){"use strict";function a(a,b){this.model=b}var b=angular.module(APP.MODULE.MAIN);b.controller("mainController",["$scope","mainModel",a])}(),function(){"use strict";function a(){function a(){this.fileModel,this.filterModel,this.pageModel}return a.prototype.setFileModel=function(a){this.fileModel=a},a.prototype.setFilterModel=function(a){this.filteredFileModel=fileModel},a.prototype.setPageModel=function(a){this.pageModel=a},a.prototype.getFileModel=function(){return this.fileModel},new a}angular.module(APP.MODULE.MAIN).service("mainModel",[a])}(),function(){"use strict";function a(a){function b(a,b,c){}return{restrict:"E",templateUrl:a.HTML.BASE_DIR+"/menu.htm",replace:!0,scope:{},controller:["$scope","$element","$attrs",b],controllerAs:"menuCtrl"}}angular.module(APP.MODULE.MENU).directive("menu",["SITE",a])}(),function(){"use strict";function a(a,b){function c(){}return c.getMenuOption=function(c,d){var e;switch(d.menuSelector){case"filter":e=b.newInstance(c,d);break;default:e=a.newInstance(c,d)}return e},c}angular.module(APP.MODULE.MENU).service("menuOptionFactory",["menuOption","filterOption",a])}(),function(){"use strict";function a(a,b,c,d,e){function f(b,c){return a.call(this,b,c)}return f.prototype=Object.create(a.prototype),f.prototype.constructor=f,f.prototype.compile=function(b,c){a.prototype.compile.apply(this,[b,c])},f.prototype.preLink=function(b,c,d){a.prototype.preLink.apply(this,[b,c,d])},f.prototype.postLink=function(c,d,e){a.prototype.postLink.apply(this,[c,d,e]),d.bind("click",function(a){b.toggleVisible()})},f.newInstance=function(a,b){return new f(a,b)},f}angular.module(APP.MODULE.NAV).factory("filterOption",["menuOption","filtersView","orFilter","baseFilter","fileView",a])}(),function(){"use strict";function a(){function a(a,b){return this.compile(a,b),{pre:this.preLink,post:this.postLink}}return a.prototype.compile=function(a,b){},a.prototype.preLink=function(a,b,c){},a.prototype.postLink=function(a,b,c){a.selected=!1,b.bind("click",function(b){a.selected=!a.selected,a.$applyAsync()})},a.newInstance=function(b,c){return new a(b,c)},a}angular.module(APP.MODULE.NAV).factory("menuOption",[a])}(),function(){"use strict";function a(a){return{restrict:"A",compile:a.getMenuOption}}angular.module(APP.MODULE.MENU).directive("menuSelector",["menuOptionFactory",a])}(),function(){"use strict";function a(){return{restrict:"A",require:"^^pagination",link:function(a,b,c,d){b.bind("click",d.first)}}}angular.module(APP.MODULE.NAV).directive("first",a)}(),function(){"use strict";function a(){return{restrict:"A",require:"^^pagination",link:function(a,b,c,d){b.bind("click",d.last)}}}angular.module(APP.MODULE.NAV).directive("last",a)}(),function(){"use strict";function a(){return{restrict:"A",require:"^^pagination",link:function(a,b,c,d){b.bind("click",d.next)}}}angular.module(APP.MODULE.NAV).directive("next",a)}(),function(){"use strict";function a(){function a(){Object.defineProperty(this,"currentPage",{configurable:!1,enumerable:!1,get:function(){return e},set:function(a){e=a}}),Object.defineProperty(this,"linesPerPage",{configurable:!1,enumerable:!1,get:function(){return h},set:function(a){h=a,e=1,f=b()}}),Object.defineProperty(this,"totalLines",{configurable:!1,enumerable:!1,get:function(){return g},set:function(a){g=a,f=b()}}),Object.defineProperty(this,"totalPages",{configurable:!1,enumerable:!1,get:function(){return f}})}function b(){if(!isNaN(h)&&!isNaN(g)){var a=Math.max(h,1),b=Math.ceil(g/a);return Math.max(b,1)}return 1}var c=200,d=1,e=1,f=d,g=0,h=c;return a.newInstance=function(){return new a},a}angular.module(APP.MODULE.NAV).factory("pageFactory",[a])}(),function(){"use strict";function a(){var a;Object.defineProperty(this,"model",{configurable:!1,enumerable:!1,get:function(){return a},set:function(b){a=b}})}angular.module(APP.MODULE.NAV).service("pageView",[a])}(),function(){"use strict";function a(a,b,c,d){function e(c,d,e){function f(a,c){a!=c&&(b.model.totalLines=a)}function g(){return angular.isDefined(a.model)&&angular.isDefined(a.model.displayMap)?a.model.displayMap.length:0}c.pageView=b,this.next=function(){b.model.currentPage<b.model.totalPages&&(b.model.currentPage++,c.$apply())},this.prev=function(){b.model.currentPage>1&&(b.model.currentPage--,c.$apply())},this.first=function(){b.model.currentPage=1,c.$apply()},this.last=function(){b.model.currentPage=b.model.totalPages,c.$apply()},c.$watch(g,f)}return{restrict:"E",templateUrl:d.HTML.BASE_DIR+"/pagination.htm",replace:!0,scope:{},controller:["$scope","$element","$attrs",e],controllerAs:"pagingCtrl"}}angular.module(APP.MODULE.NAV).directive("pagination",["fileView","pageView","pageFactory","SITE",a])}(),function(){"use strict";function a(a,b){return{restrict:"E",templateUrl:b.HTML.BASE_DIR+"/pagingDetails.htm",replace:!0,scope:{},link:function(b){b.pageView=a}}}angular.module(APP.MODULE.NAV).directive("pagingDetails",["pageView","SITE",a])}(),function(){"use strict";function a(){return{restrict:"A",require:"^^pagination",link:function(a,b,c,d){b.bind("click",d.prev)}}}angular.module(APP.MODULE.NAV).directive("prev",a)}();
//# sourceMappingURL=FileFilter.min.js.map